<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ¥‡ Hot Beans Leaderboard</title>
  <!-- ADD THESE CACHE HEADERS -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <style>
    /* SAME STYLES AS BEFORE - just the fixed logout */
    :root {
      --bg: linear-gradient(135deg, #f04e23, #ff6f47);
      --card: rgba(255,255,255,0.95);
      --text: #333;
      --accent: #f04e23;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, Arial, sans-serif;
      background: var(--bg);
      min-height: 100vh;
      padding: 2rem;
    }
    /* ... rest of your existing styles ... */
  </style>
</head>
<body>
  <!-- Login Overlay - HIDDEN BY DEFAULT -->
  <div class="login-overlay" id="loginOverlay" style="display: none;">
    <div style="background: var(--card); padding: 3rem; border-radius: 20px; text-align: center; max-width: 400px; width: 90%;">
      <h2>ğŸ”’ Teacher Login</h2>
      <input type="password" id="teacher-password" placeholder="Password">
      <br><button onclick="login()">Login</button>
      <div id="login-status"></div>
    </div>
  </div>

  <!-- Teacher Controls -->
  <div class="teacher-controls" id="teacherControls" style="display:none;">
    <span>âœ… Teacher Mode Active</span><br>
    <button onclick="logout()">Logout</button>
  </div>
  
  <!-- PUBLIC VIEW - ALWAYS VISIBLE -->
  <div class="container">
    <h1>ğŸ¥‡ Hot Beans Web Dev Leaderboard</h1>
    
    <!-- Disabled submission form - PUBLIC -->
    <div class="submit-form">
      <h2>ğŸ“§ Submit Your Work</h2>
      <p><strong>Email your teacher:</strong><br>
        "Sarah | https://sarah.github.io/hotbeans | https://github.com/sarah/hotbeans"</p>
    </div>
    
    <!-- Pending (Teacher Only) -->
    <div class="pending-section" id="pendingSection" style="display:none;">
      <h2>â³ Pending Approvals (Add New)</h2>
      <button onclick="addPendingEntry()" style="background: var(--accent); color: white; padding: 1rem 2rem; border: none; border-radius: 25px; cursor: pointer;">â• ADD STUDENT SUBMISSION</button>
      <div id="pendingList"></div>
    </div>
    
    <!-- Live Leaderboard -->
    <div class="leaderboard">
      <h2>ğŸ”¥ Live Class Rankings</h2>
      <table>
        <thead>
          <tr><th>ğŸ¥‡</th><th>ğŸ‘¨â€ğŸ’»</th><th>ğŸŒ Site</th><th>ğŸ“‚ Repo</th><th>ğŸ¯ Score</th><th>ğŸ—‘ï¸</th></tr>
        </thead>
        <tbody id="leaderboard"></tbody>
      </table>
    </div>
  </div>

  <script>
    const TEACHER_PASSWORD = "hotbeans2026"; // CHANGE THIS!
    let isLoggedIn = localStorage.getItem('teacher-logged-in') === 'true';
    let leaderboard = JSON.parse(localStorage.getItem('leaderboard-approved')) || [];
    let pending = JSON.parse(localStorage.getItem('leaderboard-pending')) || [];

    // **START HIDDEN** - only show on login/logout
    document.getElementById('loginOverlay').style.display = 'none';
    
    if (isLoggedIn) {
      document.getElementById('teacherControls').style.display = 'block';
      document.getElementById('pendingSection').style.display = 'block';
      renderPending();
      renderLeaderboard();
    }

    function login() {
      if (document.getElementById('teacher-password').value === TEACHER_PASSWORD) {
        isLoggedIn = true;
        localStorage.setItem('teacher-logged-in', 'true');
        
        // HIDE LOGIN, SHOW TEACHER CONTROLS
        document.getElementById('loginOverlay').style.display = 'none';
        document.getElementById('teacherControls').style.display = 'block';
        document.getElementById('pendingSection').style.display = 'block';
        
        renderPending();
        renderLeaderboard();
      } else {
        document.getElementById('login-status').innerHTML = 'âŒ Wrong password!';
        document.getElementById('login-status').style.color = '#dc3545';
      }
    }

    function logout() {
      // **CRITICAL FIXES:**
      isLoggedIn = false;
      localStorage.removeItem('teacher-logged-in');
      
      // HIDE EVERYTHING teacher-related
      document.getElementById('teacherControls').style.display = 'none';
      document.getElementById('pendingSection').style.display = 'none';
      
      // **DO NOT SHOW LOGIN OVERLAY** - let students see public leaderboard
      document.getElementById('loginOverlay').style.display = 'none';
      
      // Clear input
      document.getElementById('teacher-password').value = '';
    }

    function addPendingEntry() {
      const name = prompt('Student Name:');
      const site = prompt('Site URL (github.io):');
      const repo = prompt('Repo URL (github.com):');
      
      if (name && site && repo && site.includes('github.io') && repo.includes('github.com')) {
        pending.unshift({
          name, site, repo, 
          id: Date.now(), 
          timestamp: new Date().toLocaleString()
        });
        localStorage.setItem('leaderboard-pending', JSON.stringify(pending));
        renderPending();
      } else {
        alert('All fields required + must be GitHub URLs!');
      }
    }

    // ... rest of render functions SAME AS BEFORE ...
    
    function renderPending() {
      document.getElementById('pendingList').innerHTML = pending.map(entry => `
        <div style="border: 1px solid #ddd; padding: 1.5rem; margin: 1rem 0; border-radius: 10px; background: #f8f9fa;">
          <strong>${entry.name}</strong> | ${entry.timestamp}<br>
          ğŸŒ <a href="${entry.site}" target="_blank">${entry.site.replace('https://','')}</a><br>
          ğŸ“‚ <a href="${entry.repo}" target="_blank">${entry.repo.replace('https://github.com/','')}</a><br>
          <button class="approval-btn approval-yes" onclick="approve(${entry.id})">âœ… APPROVE & SCORE</button>
          <button class="approval-btn approval-no" onclick="reject(${entry.id})">âŒ REJECT</button>
        </div>
      `).join('') || '<p>No pending submissions</p>';
    }

    // ... approve, reject, renderLeaderboard, remove functions SAME AS BEFORE ...
  </script>
</body>
</html>
