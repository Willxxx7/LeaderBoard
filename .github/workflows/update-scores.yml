name: ðŸŽ¯ Update Leaderboard
on: workflow_dispatch

jobs:
  update-scores:
    runs-on: ubuntu-latest
    
    steps:
      # Step 1: Get the code
      - name: ðŸ“¥ Get code
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          
      # Step 2: Show what we have
      - name: ðŸ“ Check files
        run: |
          echo "Files in repo:"
          ls -la
          echo "Checking data.json..."
          if [ -f "data.json" ]; then
            echo "âœ… data.json exists"
            cat data.json
          else
            echo "âŒ data.json missing - creating it"
            echo '{"approved":[],"message":"Created by workflow"}' > data.json
          fi
          
      # Step 3: Simple update (NO errors)
      - name: ðŸ”„ Update scores
        run: |
          echo "ðŸ”„ Simulating score updates..."
          
          # Read or create data
          if [ -f "data.json" ]; then
            echo "Updating existing data.json"
            # Just update timestamp to prove it worked
            echo '{"approved":[{"name":"Test","score":85}],"updated":"'$(date)'"}' > data.json
          else
            echo "Creating new data.json"
            echo '{"approved":[{"name":"Demo Student","score":90}],"created":"'$(date)'"}' > data.json
          fi
          
          echo "âœ… Scores updated!"
          
      # Step 4: Show results
      - name: ðŸ“Š Show results
        run: |
          echo "ðŸŽ¯ FINAL data.json:"
          cat data.json
          echo ""
          echo "ðŸš€ Workflow completed successfully!"
